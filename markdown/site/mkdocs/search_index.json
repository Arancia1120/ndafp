{
    "docs": [
        {
            "location": "/", 
            "text": "Welcome to MkDocs\n\n\nFor full documentation visit \nmkdocs.org\n.\n\n\nCommands\n\n\n\n\nmkdocs new [dir-name]\n - Create a new project.\n\n\nmkdocs serve\n - Start the live-reloading docs server.\n\n\nmkdocs build\n - Build the documentation site.\n\n\nmkdocs help\n - Print this help message.\n\n\n\n\nProject layout\n\n\nmkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.", 
            "title": "Home"
        }, 
        {
            "location": "/#welcome-to-mkdocs", 
            "text": "For full documentation visit  mkdocs.org .", 
            "title": "Welcome to MkDocs"
        }, 
        {
            "location": "/#commands", 
            "text": "mkdocs new [dir-name]  - Create a new project.  mkdocs serve  - Start the live-reloading docs server.  mkdocs build  - Build the documentation site.  mkdocs help  - Print this help message.", 
            "title": "Commands"
        }, 
        {
            "location": "/#project-layout", 
            "text": "mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.", 
            "title": "Project layout"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/", 
            "text": "\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u57fa\u56e0\u7ec4 SNPs \u5206\u6790\n\n\nG20\u5907\u6218\u671f\u95f4\uff0c\u5355\u4f4d\u8981\u52a0\u5f3a\u751f\u7269\u6050\u6016\u4e8b\u4ef6\u7684\u9632\u63a7\u80fd\u529b\u3002\u6700\u8457\u540d\u7684\u7ec6\u83cc\u6027\u751f\u7269\u6050\u6016\u6218\u5242\u5c31\u662f\u542b\u6709\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u7684\u767d\u8272\u7c89\u672b\u3002\u7531\u4e8e\u65e5\u5e38\u5de5\u4f5c\u4e2d\u65e0\u6cd5\u63a5\u89e6\u5230\u8fd9\u4e9b\u75c5\u539f\uff0c\u56e0\u6b64\u5728\u7ecf\u9a8c\u548c\u6280\u80fd\u65b9\u9762\u90fd\u53ea\u80fd\u5904\u4e8e\u7406\u8bba\u72b6\u6001\uff08\u5373\u4f7f\u5b9e\u6218\u4e00\u822c\u4e5f\u662f\u7531\u519b\u79d1\u9662\u7b49\u673a\u6784\u51fa\u9762\uff09\u3002\u4f46\u662f\u4e3a\u4e86\u80fd\u529b\u5efa\u8bbe\uff0c\u5e94\u5bf9\u4e07\u4e00\u53d1\u751f\u7684\u7591\u4f3c\u4e8b\u4ef6\uff0c\u5728\u57fa\u56e0\u7ec4\u6570\u636e\u5206\u6790\u7684\u6280\u672f\u65b9\u9762\u8fd8\u662f\u53ef\u4ee5\u505a\u597d\u51c6\u5907\u3002\u6784\u5efa\u76f8\u5e94\u7684\u5206\u6790\u6d41\u7a0b\uff0c\u5728\u83b7\u5f97\u83cc\u682a\u57fa\u56e0\u7ec4\u6570\u636e\u540e\u53ef\u4ee5\u7b2c\u4e00\u65f6\u95f4\u5c31\u8fdb\u884c\u6eaf\u6e90\u65b9\u9762\u7684\u7814\u7a76\u3002\u4ece\u800c\u5728\u8fd9\u51c6\u5907\u5de5\u4f5c\u7684\u8fc7\u7a0b\u4e2d\u5f62\u6210\u4e86\u6b64\u6587\u6863\u3002\u4e3b\u8981\u76ee\u7684\u4e5f\u662f\u4e3a\u4e86\u629b\u7816\u5f15\u7389\uff0c\u505a\u5230\u4e3e\u4e00\u53cd\u4e09\uff0c\u7ed9\u5176\u4ed6\u7ec6\u83cc\u6027\u75c5\u539f\u5fae\u751f\u7269\u57fa\u56e0\u7ec4\u6eaf\u6e90\u5206\u6790\u65f6\u63d0\u4f9b\u53c2\u8003\u3002\n\n\n\u8f6f\u4ef6\u4e2d\u4f7f\u7528\u7684\u4e00\u4e9b\u53c2\u6570\u662f\u6839\u636e\u81ea\u5df1\u7684\u670d\u52a1\u5668\u8bbe\u7f6e\u7684\uff0c\u5177\u4f53\u8fd0\u884c\u65f6\u9700\u8981\u6839\u636e\u8ba1\u7b97\u673a\u914d\u7f6e\u8fdb\u884c\u76f8\u5e94\u7684\u8c03\u6574\u3002\u6211\u4eec\u670d\u52a1\u5668\u7684\u914d\u7f6e\u5982\u4e0b\uff1a\n\n\n\n\nCPU: E3 2650v3 x2\n\n\nMemory: ECC 16G x8\n\n\nHarddisk: 7200\u8f6c 1T x4 \u7ec4 Raid 5 + 1 Hotspare\n\n\nSystem: Ubuntu 16.04 LTS 64bit\n\n\n\n\n1. \u83b7\u53d6\u516c\u5171\u6570\u636e\u5e93\u6570\u636e\n\n\n\u624b\u4e2d\u6ca1\u6709\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u7684\u8d44\u6e90\uff0c\u81ea\u5df1\u6ca1\u6709\u529e\u6cd5\u505a\u6d4b\u5e8f\u7684\u524d\u63d0\u4e0b\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u4e0b\u8f7d NCBI SRA \u6570\u636e\u5e93\u4e2d\u4ed6\u4eba\u63d0\u4ea4\u7684\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u6765\u4f5c\u5206\u6790\u3002\n\n\n\u9996\u5148\u68c0\u7d22 NCBI SRA \u6570\u636e\u5e93\u4e2d\u6240\u6709\u4f7f\u7528 illumina \u5e73\u53f0\u5bf9\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u57fa\u56e0\u7ec4\u8fdb\u884c PE \u6d4b\u5e8f\u7684 \u5927\u4e8e 100M \u7684 NGS \u6570\u636e\uff0c\u5e76\u5728\u4e0b\u8f7d\u8fd9\u4e9b sra \u6570\u636e\u540e\u8f6c\u6362\u6210 fastq.gz \u683c\u5f0f\u3002\u4f7f\u7528\u7684\u5de5\u5177\u4e3b\u8981\u4e3a \nedirect\n \u548c \nsra-tools\n\u3002\n\n\n$ esearch -db sra -query '\nBacillus anthracis\n[Organism] AND \\\n\n (Hiseq[ALL] OR Miseq[ALL]) AND \nstrategy wgs\n[Properties]' | \\\n\n efetch -db sra -format runinfo | grep 'PAIRED' | grep '^[DSE]RR*' | \\\n\n awk -F',' '{if($5\n100000000) print $1}' | sort -n | \\\n\n xargs fastq-dump --split-files --gzip --outdir bacillus_anthracis\n\n\n\n\n\u867d\u7136\u6211\u4eec\u68c0\u7d22\u65f6\u9650\u5b9a\u4e86 PE \u6d4b\u5e8f\u6570\u636e\uff0c\u4f46\u662f\u5f88\u591a\u65f6\u5019\u6570\u636e\u5e93\u91cc\u7684\u4fe1\u606f\u4e0d\u51c6\u786e\uff0c\u8fd8\u662f\u4f1a\u6709\u5f88\u591a SE \u7684\u6570\u636e\u4f1a\u88ab\u4e0b\u8f7d\u3002\u786e\u5b9a PE \u6216\u8005 SE \u7684\u65b9\u6cd5\u5f88\u591a\u3002\n\n\n# sra-stat \u7edf\u8ba1 sra \u6587\u4ef6\uff0cnreads=1 \u8868\u793a SE \u6d4b\u5e8f\uff0cnreads=2 \u8868\u793a PE \u6d4b\u5e8f\u3002\u7a0b\u5e8f\u7edf\u8ba1\u6574\u4e2a\u6587\u4ef6\uff0c\u901f\u5ea6\u6bd4\u8f83\u6162\n$ sra-stat -xs *.sra | grep \nnreads\n\n# \u6279\u91cf\u5220\u9664\n$ parallel 'sra-stat -xs' ::: *.sra | xtract -Pattern Run -element Run@accession \\\n\n Statistics@nreads | awk '{if($2==1) print $1}' | xargs rm\n\n# fastq-dump \u8f93\u51fa\u4e00\u4e2a reads\uff0c\u8ba1\u7b97\u884c\u6570\u5982\u679c\u662f4\uff0c\u90a3\u4e48\u5c31\u662f SE\uff0c\u5982\u679c\u662f8,\u5219\u662f PE\n$ fastq-dump -X 1 --split-spot -Z SRR955386.sra | wc -l\n\n# fastq-dump \u81ea\u5df1\u5224\u65ad\uff0c\u5f53 sra \u6587\u4ef6\u662f SE \u6d4b\u5e8f\u65f6\uff0cfastq-dump \u53ea\u80fd\u751f\u62101\u4e2a *_1.fastq \u6587\u4ef6\n$ fastq-dump --split-files ERR493452.sra\n\n# fastq-dump \u53ea\u80fd\u8c03\u7528\u5355\u6838\u8f6c\u6362\uff0c\u53ef\u4ee5\u4f7f\u7528 parallel \u5de5\u5177\u5e76\u884c\u5904\u7406\u52a0\u5feb\u901f\u5ea6\u3002\n$ parallel \nfastq-dump --split-files --gzip --outdir bacillus_anthracis\n ::: *.sra\n\n\n\n\n\u6709\u65f6\u5019\u6709\u4e9bsra\u6587\u4ef6\u5728 dump \u65f6\u4f1a\u51fa\u9519\uff0c\u4e0d\u80fd\u751f\u6210\u5bf9\u5e94\u7684 PE fastq \u6587\u4ef6\uff0c\u8fd9\u5c31\u9700\u8981\u6bd4\u8f83\u540e\u5220\u9664\u4e86\u3002\u5982\u679c\u662f mate pair \u7684\u6570\u636e\uff0c\u4f1a\u751f\u6210 \n*_3.fastq.gz\n\uff0c\u5982\u679c\u4e0d\u9700\u8981\u5219\u53ef\u624b\u5de5\u5220\u9664\u3002\n\n\n# \u6838\u5bf9 PE \u53cc\u7aef\u6d4b\u5e8f\u6587\u4ef6\u662f\u5426\u4e00\u81f4\n$ ls -l *_1.fastq.gz | awk '{print $9}' | awk -F'_' '{print $1}' \n R1.txt\n$ ls -l *_2.fastq.gz | awk '{print $9}' | awk -F'_' '{print $1}' \n R2.txt\n$ diff R1.txt R2.txt\n# diff \u5982\u679c2\u4e2a\u6587\u4ef6\u5185\u5bb9\u4e00\u81f4\uff0c\u5219\u7ec8\u7aef\u4e0d\u4f1a\u6709\u8f93\u51fa\u3002\u5426\u5219\u5c31\u8981\u5220\u9664\u6587\u4ef6\n\n\n\n\n2. \u6570\u636e\u7684\u524d\u671f\u5904\u7406\n\n\n\u7531\u4e8e\u662f\u516c\u5171\u6570\u636e\u5e93\u4e0b\u8f7d\u7684\u6570\u636e\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u6d4b\u5e8f\u5b9e\u9a8c\u8d28\u91cf\u6216\u8005\u6570\u636e\u63d0\u4ea4\u8005\u662f\u5426\u63d0\u4ea4\u7684\u662f\u8d28\u63a7\u540e\u7684\u6570\u636e\u3002\u56e0\u6b64\u5efa\u8bae\u8981\u5bf9\u6570\u636e\u505a\u4e00\u4e9b\u524d\u671f\u7684\u8d28\u63a7\u5904\u7406\u3002\n\n\n2.1 \u6570\u636e QC\n\n\n\u9996\u5148\u5bf9\u57fa\u56e0\u7ec4 GC \u542b\u91cf\u548c Q \u503c\u8fdb\u884c\u521d\u6b65\u7b5b\u9009\uff0c\u5bf9\u4e8e\u504f\u5dee\u8f83\u5927\u7684\u6570\u636e\u8003\u8651\u76f4\u63a5\u5254\u9664\uff08\u6216\u8005\u7528\u5176\u4ed6\u8f6f\u4ef6\u9a8c\u8bc1\u770b\u662f\u5426\u662f\u9519\u8bef\u7269\u79cd\uff09\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u5de5\u5177\u4e3a \nbioawk\n \u6216 \nparallel\n\u3002\n\n\n# \u56e0\u4e3a reads \u8986\u76d6\u5ea6\u53ef\u80fd\u5e76\u4e0d\u5747\u4e00\uff0c\u9ad8\u8986\u76d6\u5ea6\u7684\u533a\u57df GC \u542b\u91cf\u6bd4\u91cd\u4f1a\u7565\u9ad8\u3002\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6b63\u5e38\u6d4b\u5e8f\u7684\u57fa\u56e0\u7ec4\u8fd9\u79cd\u533a\u57df\u76f8\u5bf9\u6765\u8bf4\u4e0d\u591a\uff0c\u5e73\u5747\u5230\u57fa\u56e0\u7ec4\u540e\u4f1a\u6574\u4f53 GC \u542b\u91cf\u5f71\u54cd\u4e0d\u5927\u3002\n$ for i in *.fastq.gz; do bioawk -c fastx 'BEGIN{n=0;q=0}{n+=gc($seq);q+=meanqual($seq)}END{print $name,n/NR,q/NR}' $i \n result.txt; done\n# awk \u7c7b\u5de5\u5177\u662f\u5355\u8fdb\u7a0b\u7684\uff0c\u4e3a\u4e86\u52a0\u901f\u53ef\u4ee5\u4f7f\u7528 parallel \u6765\u5e76\u884c\u8ba1\u7b97\n$ parallel \nbioawk -c fastx 'BEGIN{n=0;q=0}{n+=gc(\\$seq);q+=meanqual(\\$seq)}END{print \\$name,n/NR,q/NR}' \n result.txt\n ::: *.fastq.gz\n# \u6309\u7167 GC \u542b\u91cf\u6392\u5e8f\n$ cat result.txt | sort -n -k3\n\n\n\n\nR \u7ed8\u5236 gc \u5206\u5e03\u56fe\uff0c\u5982\u679c gc \u542b\u91cf\u504f\u5dee\u8d85\u8fc7 10% \u65f6\u5c31\u5254\u9664\u8be5\u57fa\u56e0\u7ec4\u6570\u636e\u3002\n\n\n library(ggplot2)\n\n data\n-read.table(\nresult.txt\n)\n\n qplot(v2, v3, data=data)\n\n\n\n\n\u7ed3\u679c\u663e\u793a\u6709\u4e00\u4e2a\u9ed1\u70b9\u7684GC\u542b\u91cf\u7279\u522b\u4f4e\uff0c\u4e14Q\u503c\u7279\u522b\u9ad8\u3002\u7ed3\u679c\u663e\u793a\u6d4b\u5e8f\u5b9e\u9a8c SRR2155551 \u548c SRR2164197 \u7684 GC \u542b\u91cf\u4ec5\u4e3a22%\uff0c\u800c\u5176\u4ed6\u6837\u672c GC \u542b\u91cf\u8303\u56f4\u572834%\uff5e41%\u3002\u4e14\u8fd92\u4e2a\u5b9e\u9a8c\u7684\u6837\u672c\u5747\u4e3a\u540c\u4e00\u4e2a\uff0c\u662f1\u4e2a\u6837\u672c\u76842\u6b64\u6d4b\u5e8f\uff08\u6216\u8005\u6570\u636e\u4e0a\u4f20\u4e862\u6b21\uff09\uff0c\u56e0\u6b64\u5c06\u5176\u5254\u9664\u3002\n\n\n2.2 \u53bb\u9664\u63a5\u5934\n\n\n\u5176\u6b21\u8981\u53bb\u9664\u63a5\u5934\u7684\u6c61\u67d3\u3002\u56e0\u4e3a\u5206\u6790\u6d41\u7a0b\u4e2d\u4e0d\u4ec5\u5305\u62ec mapping \u7684\u65b9\u5f0f\uff0c\u8fd8\u5305\u542b de novo assembly\uff0c\u4e3a\u4e86\u907f\u514d\u63a5\u5934\u5e8f\u5217\u5bf9\u57fa\u56e0\u7ec4\u62fc\u63a5\u7684\u5f71\u54cd\uff0c\u8fd9\u91cc\u6700\u597d\u8fdb\u884c\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u5de5\u5177\u662f \nFastQC\n \u548c \nfadapa\n\n\n# \u4f7f\u7528\u811a\u672c scan_adaptors.py \u6765\u626b\u63cf\u4e0b\u8f7d\u7684\u9ad8\u901a\u91cf\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u662f\u5426\u6709\u63a5\u5934\u6c61\u67d3\u7684\u60c5\u51b5\u3002\n$ fastqc -t 40 -q --extract *.fastq.gz\n$ python scan_fastqc_report.py -d qc\n\n\n\n\n#!usr/bin/env python\n# -*- coding: utf-8 -*-\n# scripts name: scan_fastqc_report.py\nimport os\nfrom Bio.Seq import Seq\nfrom Bio import SeqIO\nfrom Bio.SeqRecord import SeqRecord\nfrom Bio.Alphabet import generic_nucleotide\nfrom fadapa import Fadapa\nimport argparse\n\nparser = argparse.ArgumentParser()\nparser.add_argument('-i', '--input', action='store', dest='qcfile', type=str, help=\nfastqc extract data file\n)\nparser.add_argument('-o', '--output', action='store', dest='adaptor', type=str, help=\nadaptors file\n)\nargs = parser.parse_args()\nqc_file = Fadapa(args.qcfile)\n\nif qc_file.summary()[-3][0] == 'fail':\n    adaptors = []\n    ors = qc_file.clean_data(\nOverrepresented sequences\n)\n    ors.pop(0)\n\n    for (index, seq) in enumerate(ors):\n        if 'NNNNNN' in seq[0]:\n            continue\n        adaptors.append(SeqRecord(Seq(seq[0], generic_nucleotide), id=\nadaptor_%d\n % (index+1)))\n\n    if not os.path.exists(args.adaptor):\n        os.makedirs(args.adaptor)\n    SeqIO.write(adaptors, \n%s/adaptor.fasta\n % args.adaptor, \nfasta\n)\n    print \nOverrepresented sequences has been save to adaptors.fasta\n\nelse:\n    print \nNo Overrepresented sequences\n\n\n\n\n\n3. Pangenome \u5206\u6790\n\n\n3.1 \u57fa\u56e0\u7ec4\u7ec4\u88c5\n\n\n3.2 \u57fa\u56e0\u7ec4\u6ce8\u91ca\n\n\n3.3 Roary \n Phandango\n\n\n3.4 Harvest\n\n\n\n\n\n\n\n3. SNPs \u6784\u5efa\u8fdb\u5316\u6811\n\n\n3.1 \u7528 Snippy \u83b7\u5f97 snps\n\n\n$ for i in *.fastq.gz | sort | uniq; \\\n\n do snippy --cpus 20 --outdir $i -ref reference.fa \\\n\n --R1 $i*_1*.fastq.gz --R2 $i*_2*.fastq.gz; done\n$ snippy-core --prefix core-snps SRR* DRR* ERR*\n\n\n\n\n3.2 \u7528 RAxML \u6784\u5efa\u8fdb\u5316\u6811\n\n\n$ raxml -f a -x 12345 -p 12345 -# 100 -m GTRGAMMA -s core-snps.aln -n ex -T 40\n\n\n\n\n3.3 \u7528 Figtree \u7ed8\u5236\u8fdb\u5316\u6811\n\n\n$ scp user@server-ip:/path/RAxML_bestTree.ex .\n$ figtree RAxML_bestTree.ex \n\n\n\n\n\n4. \u57fa\u56e0\u7ec4\u7ec4\u88c5\n\n\n\n\n\n\n\n5. Pangenome \u5206\u6790\n\n\n\n\n\u76f8\u5173\u8f6f\u4ef6\u5b89\u88c5\n\n\nedirect\n\n\n$ wget ftp://ftp.ncbi.nlm.nih.gov/entrez/entrezdirect/edirect.tar.gz\n$ sudo tar zxf edirect.tar.gz -C /opt\n$ sudo chown -R root:root /opt/edirect\n$ cd /opt/edirect \n sudo ./setup.sh\n$ sudo ln -s /opt/edirect/* /usr/local/sbin/\n\n\n\n\nsra-tools\n\n\n$ wget http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.7.0/sratoolkit.2.7.0-ubuntu64.tar.gz\n$ sudo tar zxf sratoolkit.2.7.0-ubuntu64.tar.gz -C /opt/sratoolkit\n$ sudo chown -R root:root /opt/sratoolkit \n cd /opt/sratoolkit\n$ sudo ln -s `pwd`/bin/* /usr/local/sbin/\n\n\n\n\nbio-awk\n\n\n$ sudo apt-get install bison\n$ git clone https://github.com/lh3/bioawk\n$ cd bioawk \n make\n$ sudo cp bioawk /usr/local/sbin\n\n\n\n\nparallel\n\n\n$ sudo apt install parallel\n\n\n\n\ngplot\n\n\n$ sudo apt install gnuplot\n$ git clone https://github.com/RhysU/gplot\n$ sudo cp gplot/gplot /usr/local/sbin\n\n\n\n\nFastQC\n\n\n$ wget http://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip\n$ sudo unzip fastqc_v0.11.5.zip\n$ sudo mv fastqc_v0.11.5 /opt/fastqc \n sudo chown -R root:root /opt/fastqc\n$ sudo cp /opt/fastqc/fastqc /usr/local/sbin\n\n\n\n\nFadapa\n\n\n$ sudo pip install fadapa\n\n\n\n\nsnippy\n\n\n$ git clone https://github.com/tseemann/snippy\n$ sudo cp snippy/bin/* /usr/local/sbin\n$ sudo cp snippy/binaries/linux/* /usr/local/sbin\n\n\n\n\nRAxML\n\n\n$ wget https://github.com/stamatak/standard-RAxML/archive/v8.1.17.tar.gz\n$ sudo tar zxf v8.1.17.tar.gz -C /opt/raxml\n$ sudo chown -R root:root /opt/raxml \n cd /opt/raxml\n$ sudo make -f Makefile.SSE3.PTHREADS.gcc\n$ sudo ln -s `pwd`/raxmlHPC-PTHREADS-SSE3 /usr/local/raxml\n\n\n\n\nReference\n\n\n\n\nedirect help book: http://www.ncbi.nlm.nih.gov/books/NBK179288/\n\n\nsra-tools wiki: https://github.com/ncbi/sra-tools/wiki\n\n\nparallel tutorial: https://www.biostars.org/p/63816/\n\n\ngnuplot tutorial: http://lzz5235.github.io/2016/01/12/gnuplot.html\n\n\ngplot usage: https://github.com/RhysU/gplot/blob/master/README.md", 
            "title": "Blog"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#snps", 
            "text": "G20\u5907\u6218\u671f\u95f4\uff0c\u5355\u4f4d\u8981\u52a0\u5f3a\u751f\u7269\u6050\u6016\u4e8b\u4ef6\u7684\u9632\u63a7\u80fd\u529b\u3002\u6700\u8457\u540d\u7684\u7ec6\u83cc\u6027\u751f\u7269\u6050\u6016\u6218\u5242\u5c31\u662f\u542b\u6709\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u7684\u767d\u8272\u7c89\u672b\u3002\u7531\u4e8e\u65e5\u5e38\u5de5\u4f5c\u4e2d\u65e0\u6cd5\u63a5\u89e6\u5230\u8fd9\u4e9b\u75c5\u539f\uff0c\u56e0\u6b64\u5728\u7ecf\u9a8c\u548c\u6280\u80fd\u65b9\u9762\u90fd\u53ea\u80fd\u5904\u4e8e\u7406\u8bba\u72b6\u6001\uff08\u5373\u4f7f\u5b9e\u6218\u4e00\u822c\u4e5f\u662f\u7531\u519b\u79d1\u9662\u7b49\u673a\u6784\u51fa\u9762\uff09\u3002\u4f46\u662f\u4e3a\u4e86\u80fd\u529b\u5efa\u8bbe\uff0c\u5e94\u5bf9\u4e07\u4e00\u53d1\u751f\u7684\u7591\u4f3c\u4e8b\u4ef6\uff0c\u5728\u57fa\u56e0\u7ec4\u6570\u636e\u5206\u6790\u7684\u6280\u672f\u65b9\u9762\u8fd8\u662f\u53ef\u4ee5\u505a\u597d\u51c6\u5907\u3002\u6784\u5efa\u76f8\u5e94\u7684\u5206\u6790\u6d41\u7a0b\uff0c\u5728\u83b7\u5f97\u83cc\u682a\u57fa\u56e0\u7ec4\u6570\u636e\u540e\u53ef\u4ee5\u7b2c\u4e00\u65f6\u95f4\u5c31\u8fdb\u884c\u6eaf\u6e90\u65b9\u9762\u7684\u7814\u7a76\u3002\u4ece\u800c\u5728\u8fd9\u51c6\u5907\u5de5\u4f5c\u7684\u8fc7\u7a0b\u4e2d\u5f62\u6210\u4e86\u6b64\u6587\u6863\u3002\u4e3b\u8981\u76ee\u7684\u4e5f\u662f\u4e3a\u4e86\u629b\u7816\u5f15\u7389\uff0c\u505a\u5230\u4e3e\u4e00\u53cd\u4e09\uff0c\u7ed9\u5176\u4ed6\u7ec6\u83cc\u6027\u75c5\u539f\u5fae\u751f\u7269\u57fa\u56e0\u7ec4\u6eaf\u6e90\u5206\u6790\u65f6\u63d0\u4f9b\u53c2\u8003\u3002  \u8f6f\u4ef6\u4e2d\u4f7f\u7528\u7684\u4e00\u4e9b\u53c2\u6570\u662f\u6839\u636e\u81ea\u5df1\u7684\u670d\u52a1\u5668\u8bbe\u7f6e\u7684\uff0c\u5177\u4f53\u8fd0\u884c\u65f6\u9700\u8981\u6839\u636e\u8ba1\u7b97\u673a\u914d\u7f6e\u8fdb\u884c\u76f8\u5e94\u7684\u8c03\u6574\u3002\u6211\u4eec\u670d\u52a1\u5668\u7684\u914d\u7f6e\u5982\u4e0b\uff1a   CPU: E3 2650v3 x2  Memory: ECC 16G x8  Harddisk: 7200\u8f6c 1T x4 \u7ec4 Raid 5 + 1 Hotspare  System: Ubuntu 16.04 LTS 64bit", 
            "title": "\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u57fa\u56e0\u7ec4 SNPs \u5206\u6790"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#1", 
            "text": "\u624b\u4e2d\u6ca1\u6709\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u7684\u8d44\u6e90\uff0c\u81ea\u5df1\u6ca1\u6709\u529e\u6cd5\u505a\u6d4b\u5e8f\u7684\u524d\u63d0\u4e0b\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u4e0b\u8f7d NCBI SRA \u6570\u636e\u5e93\u4e2d\u4ed6\u4eba\u63d0\u4ea4\u7684\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u6765\u4f5c\u5206\u6790\u3002  \u9996\u5148\u68c0\u7d22 NCBI SRA \u6570\u636e\u5e93\u4e2d\u6240\u6709\u4f7f\u7528 illumina \u5e73\u53f0\u5bf9\u70ad\u75bd\u82bd\u80de\u6746\u83cc\u57fa\u56e0\u7ec4\u8fdb\u884c PE \u6d4b\u5e8f\u7684 \u5927\u4e8e 100M \u7684 NGS \u6570\u636e\uff0c\u5e76\u5728\u4e0b\u8f7d\u8fd9\u4e9b sra \u6570\u636e\u540e\u8f6c\u6362\u6210 fastq.gz \u683c\u5f0f\u3002\u4f7f\u7528\u7684\u5de5\u5177\u4e3b\u8981\u4e3a  edirect  \u548c  sra-tools \u3002  $ esearch -db sra -query ' Bacillus anthracis [Organism] AND \\  (Hiseq[ALL] OR Miseq[ALL]) AND  strategy wgs [Properties]' | \\  efetch -db sra -format runinfo | grep 'PAIRED' | grep '^[DSE]RR*' | \\  awk -F',' '{if($5 100000000) print $1}' | sort -n | \\  xargs fastq-dump --split-files --gzip --outdir bacillus_anthracis  \u867d\u7136\u6211\u4eec\u68c0\u7d22\u65f6\u9650\u5b9a\u4e86 PE \u6d4b\u5e8f\u6570\u636e\uff0c\u4f46\u662f\u5f88\u591a\u65f6\u5019\u6570\u636e\u5e93\u91cc\u7684\u4fe1\u606f\u4e0d\u51c6\u786e\uff0c\u8fd8\u662f\u4f1a\u6709\u5f88\u591a SE \u7684\u6570\u636e\u4f1a\u88ab\u4e0b\u8f7d\u3002\u786e\u5b9a PE \u6216\u8005 SE \u7684\u65b9\u6cd5\u5f88\u591a\u3002  # sra-stat \u7edf\u8ba1 sra \u6587\u4ef6\uff0cnreads=1 \u8868\u793a SE \u6d4b\u5e8f\uff0cnreads=2 \u8868\u793a PE \u6d4b\u5e8f\u3002\u7a0b\u5e8f\u7edf\u8ba1\u6574\u4e2a\u6587\u4ef6\uff0c\u901f\u5ea6\u6bd4\u8f83\u6162\n$ sra-stat -xs *.sra | grep  nreads \n# \u6279\u91cf\u5220\u9664\n$ parallel 'sra-stat -xs' ::: *.sra | xtract -Pattern Run -element Run@accession \\  Statistics@nreads | awk '{if($2==1) print $1}' | xargs rm\n\n# fastq-dump \u8f93\u51fa\u4e00\u4e2a reads\uff0c\u8ba1\u7b97\u884c\u6570\u5982\u679c\u662f4\uff0c\u90a3\u4e48\u5c31\u662f SE\uff0c\u5982\u679c\u662f8,\u5219\u662f PE\n$ fastq-dump -X 1 --split-spot -Z SRR955386.sra | wc -l\n\n# fastq-dump \u81ea\u5df1\u5224\u65ad\uff0c\u5f53 sra \u6587\u4ef6\u662f SE \u6d4b\u5e8f\u65f6\uff0cfastq-dump \u53ea\u80fd\u751f\u62101\u4e2a *_1.fastq \u6587\u4ef6\n$ fastq-dump --split-files ERR493452.sra\n\n# fastq-dump \u53ea\u80fd\u8c03\u7528\u5355\u6838\u8f6c\u6362\uff0c\u53ef\u4ee5\u4f7f\u7528 parallel \u5de5\u5177\u5e76\u884c\u5904\u7406\u52a0\u5feb\u901f\u5ea6\u3002\n$ parallel  fastq-dump --split-files --gzip --outdir bacillus_anthracis  ::: *.sra  \u6709\u65f6\u5019\u6709\u4e9bsra\u6587\u4ef6\u5728 dump \u65f6\u4f1a\u51fa\u9519\uff0c\u4e0d\u80fd\u751f\u6210\u5bf9\u5e94\u7684 PE fastq \u6587\u4ef6\uff0c\u8fd9\u5c31\u9700\u8981\u6bd4\u8f83\u540e\u5220\u9664\u4e86\u3002\u5982\u679c\u662f mate pair \u7684\u6570\u636e\uff0c\u4f1a\u751f\u6210  *_3.fastq.gz \uff0c\u5982\u679c\u4e0d\u9700\u8981\u5219\u53ef\u624b\u5de5\u5220\u9664\u3002  # \u6838\u5bf9 PE \u53cc\u7aef\u6d4b\u5e8f\u6587\u4ef6\u662f\u5426\u4e00\u81f4\n$ ls -l *_1.fastq.gz | awk '{print $9}' | awk -F'_' '{print $1}'   R1.txt\n$ ls -l *_2.fastq.gz | awk '{print $9}' | awk -F'_' '{print $1}'   R2.txt\n$ diff R1.txt R2.txt\n# diff \u5982\u679c2\u4e2a\u6587\u4ef6\u5185\u5bb9\u4e00\u81f4\uff0c\u5219\u7ec8\u7aef\u4e0d\u4f1a\u6709\u8f93\u51fa\u3002\u5426\u5219\u5c31\u8981\u5220\u9664\u6587\u4ef6", 
            "title": "1. \u83b7\u53d6\u516c\u5171\u6570\u636e\u5e93\u6570\u636e"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#2", 
            "text": "\u7531\u4e8e\u662f\u516c\u5171\u6570\u636e\u5e93\u4e0b\u8f7d\u7684\u6570\u636e\uff0c\u5e76\u4e0d\u80fd\u4fdd\u8bc1\u6d4b\u5e8f\u5b9e\u9a8c\u8d28\u91cf\u6216\u8005\u6570\u636e\u63d0\u4ea4\u8005\u662f\u5426\u63d0\u4ea4\u7684\u662f\u8d28\u63a7\u540e\u7684\u6570\u636e\u3002\u56e0\u6b64\u5efa\u8bae\u8981\u5bf9\u6570\u636e\u505a\u4e00\u4e9b\u524d\u671f\u7684\u8d28\u63a7\u5904\u7406\u3002", 
            "title": "2. \u6570\u636e\u7684\u524d\u671f\u5904\u7406"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#21-qc", 
            "text": "\u9996\u5148\u5bf9\u57fa\u56e0\u7ec4 GC \u542b\u91cf\u548c Q \u503c\u8fdb\u884c\u521d\u6b65\u7b5b\u9009\uff0c\u5bf9\u4e8e\u504f\u5dee\u8f83\u5927\u7684\u6570\u636e\u8003\u8651\u76f4\u63a5\u5254\u9664\uff08\u6216\u8005\u7528\u5176\u4ed6\u8f6f\u4ef6\u9a8c\u8bc1\u770b\u662f\u5426\u662f\u9519\u8bef\u7269\u79cd\uff09\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u5de5\u5177\u4e3a  bioawk  \u6216  parallel \u3002  # \u56e0\u4e3a reads \u8986\u76d6\u5ea6\u53ef\u80fd\u5e76\u4e0d\u5747\u4e00\uff0c\u9ad8\u8986\u76d6\u5ea6\u7684\u533a\u57df GC \u542b\u91cf\u6bd4\u91cd\u4f1a\u7565\u9ad8\u3002\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6b63\u5e38\u6d4b\u5e8f\u7684\u57fa\u56e0\u7ec4\u8fd9\u79cd\u533a\u57df\u76f8\u5bf9\u6765\u8bf4\u4e0d\u591a\uff0c\u5e73\u5747\u5230\u57fa\u56e0\u7ec4\u540e\u4f1a\u6574\u4f53 GC \u542b\u91cf\u5f71\u54cd\u4e0d\u5927\u3002\n$ for i in *.fastq.gz; do bioawk -c fastx 'BEGIN{n=0;q=0}{n+=gc($seq);q+=meanqual($seq)}END{print $name,n/NR,q/NR}' $i   result.txt; done\n# awk \u7c7b\u5de5\u5177\u662f\u5355\u8fdb\u7a0b\u7684\uff0c\u4e3a\u4e86\u52a0\u901f\u53ef\u4ee5\u4f7f\u7528 parallel \u6765\u5e76\u884c\u8ba1\u7b97\n$ parallel  bioawk -c fastx 'BEGIN{n=0;q=0}{n+=gc(\\$seq);q+=meanqual(\\$seq)}END{print \\$name,n/NR,q/NR}'   result.txt  ::: *.fastq.gz\n# \u6309\u7167 GC \u542b\u91cf\u6392\u5e8f\n$ cat result.txt | sort -n -k3  R \u7ed8\u5236 gc \u5206\u5e03\u56fe\uff0c\u5982\u679c gc \u542b\u91cf\u504f\u5dee\u8d85\u8fc7 10% \u65f6\u5c31\u5254\u9664\u8be5\u57fa\u56e0\u7ec4\u6570\u636e\u3002   library(ggplot2)  data -read.table( result.txt )  qplot(v2, v3, data=data)  \u7ed3\u679c\u663e\u793a\u6709\u4e00\u4e2a\u9ed1\u70b9\u7684GC\u542b\u91cf\u7279\u522b\u4f4e\uff0c\u4e14Q\u503c\u7279\u522b\u9ad8\u3002\u7ed3\u679c\u663e\u793a\u6d4b\u5e8f\u5b9e\u9a8c SRR2155551 \u548c SRR2164197 \u7684 GC \u542b\u91cf\u4ec5\u4e3a22%\uff0c\u800c\u5176\u4ed6\u6837\u672c GC \u542b\u91cf\u8303\u56f4\u572834%\uff5e41%\u3002\u4e14\u8fd92\u4e2a\u5b9e\u9a8c\u7684\u6837\u672c\u5747\u4e3a\u540c\u4e00\u4e2a\uff0c\u662f1\u4e2a\u6837\u672c\u76842\u6b64\u6d4b\u5e8f\uff08\u6216\u8005\u6570\u636e\u4e0a\u4f20\u4e862\u6b21\uff09\uff0c\u56e0\u6b64\u5c06\u5176\u5254\u9664\u3002", 
            "title": "2.1 \u6570\u636e QC"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#22", 
            "text": "\u5176\u6b21\u8981\u53bb\u9664\u63a5\u5934\u7684\u6c61\u67d3\u3002\u56e0\u4e3a\u5206\u6790\u6d41\u7a0b\u4e2d\u4e0d\u4ec5\u5305\u62ec mapping \u7684\u65b9\u5f0f\uff0c\u8fd8\u5305\u542b de novo assembly\uff0c\u4e3a\u4e86\u907f\u514d\u63a5\u5934\u5e8f\u5217\u5bf9\u57fa\u56e0\u7ec4\u62fc\u63a5\u7684\u5f71\u54cd\uff0c\u8fd9\u91cc\u6700\u597d\u8fdb\u884c\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u5de5\u5177\u662f  FastQC  \u548c  fadapa  # \u4f7f\u7528\u811a\u672c scan_adaptors.py \u6765\u626b\u63cf\u4e0b\u8f7d\u7684\u9ad8\u901a\u91cf\u57fa\u56e0\u7ec4\u6d4b\u5e8f\u6570\u636e\u662f\u5426\u6709\u63a5\u5934\u6c61\u67d3\u7684\u60c5\u51b5\u3002\n$ fastqc -t 40 -q --extract *.fastq.gz\n$ python scan_fastqc_report.py -d qc  #!usr/bin/env python\n# -*- coding: utf-8 -*-\n# scripts name: scan_fastqc_report.py\nimport os\nfrom Bio.Seq import Seq\nfrom Bio import SeqIO\nfrom Bio.SeqRecord import SeqRecord\nfrom Bio.Alphabet import generic_nucleotide\nfrom fadapa import Fadapa\nimport argparse\n\nparser = argparse.ArgumentParser()\nparser.add_argument('-i', '--input', action='store', dest='qcfile', type=str, help= fastqc extract data file )\nparser.add_argument('-o', '--output', action='store', dest='adaptor', type=str, help= adaptors file )\nargs = parser.parse_args()\nqc_file = Fadapa(args.qcfile)\n\nif qc_file.summary()[-3][0] == 'fail':\n    adaptors = []\n    ors = qc_file.clean_data( Overrepresented sequences )\n    ors.pop(0)\n\n    for (index, seq) in enumerate(ors):\n        if 'NNNNNN' in seq[0]:\n            continue\n        adaptors.append(SeqRecord(Seq(seq[0], generic_nucleotide), id= adaptor_%d  % (index+1)))\n\n    if not os.path.exists(args.adaptor):\n        os.makedirs(args.adaptor)\n    SeqIO.write(adaptors,  %s/adaptor.fasta  % args.adaptor,  fasta )\n    print  Overrepresented sequences has been save to adaptors.fasta \nelse:\n    print  No Overrepresented sequences", 
            "title": "2.2 \u53bb\u9664\u63a5\u5934"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#3-pangenome", 
            "text": "", 
            "title": "3. Pangenome \u5206\u6790"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#31", 
            "text": "", 
            "title": "3.1 \u57fa\u56e0\u7ec4\u7ec4\u88c5"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#32", 
            "text": "", 
            "title": "3.2 \u57fa\u56e0\u7ec4\u6ce8\u91ca"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#33-roary-phandango", 
            "text": "", 
            "title": "3.3 Roary &amp; Phandango"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#34-harvest", 
            "text": "", 
            "title": "3.4 Harvest"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#3-snps", 
            "text": "", 
            "title": "3. SNPs \u6784\u5efa\u8fdb\u5316\u6811"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#31-snippy-snps", 
            "text": "$ for i in *.fastq.gz | sort | uniq; \\  do snippy --cpus 20 --outdir $i -ref reference.fa \\  --R1 $i*_1*.fastq.gz --R2 $i*_2*.fastq.gz; done\n$ snippy-core --prefix core-snps SRR* DRR* ERR*", 
            "title": "3.1 \u7528 Snippy \u83b7\u5f97 snps"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#32-raxml", 
            "text": "$ raxml -f a -x 12345 -p 12345 -# 100 -m GTRGAMMA -s core-snps.aln -n ex -T 40", 
            "title": "3.2 \u7528 RAxML \u6784\u5efa\u8fdb\u5316\u6811"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#33-figtree", 
            "text": "$ scp user@server-ip:/path/RAxML_bestTree.ex .\n$ figtree RAxML_bestTree.ex", 
            "title": "3.3 \u7528 Figtree \u7ed8\u5236\u8fdb\u5316\u6811"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#4", 
            "text": "", 
            "title": "4. \u57fa\u56e0\u7ec4\u7ec4\u88c5"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#5-pangenome", 
            "text": "", 
            "title": "5. Pangenome \u5206\u6790"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#_2", 
            "text": "edirect  $ wget ftp://ftp.ncbi.nlm.nih.gov/entrez/entrezdirect/edirect.tar.gz\n$ sudo tar zxf edirect.tar.gz -C /opt\n$ sudo chown -R root:root /opt/edirect\n$ cd /opt/edirect   sudo ./setup.sh\n$ sudo ln -s /opt/edirect/* /usr/local/sbin/  sra-tools  $ wget http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.7.0/sratoolkit.2.7.0-ubuntu64.tar.gz\n$ sudo tar zxf sratoolkit.2.7.0-ubuntu64.tar.gz -C /opt/sratoolkit\n$ sudo chown -R root:root /opt/sratoolkit   cd /opt/sratoolkit\n$ sudo ln -s `pwd`/bin/* /usr/local/sbin/  bio-awk  $ sudo apt-get install bison\n$ git clone https://github.com/lh3/bioawk\n$ cd bioawk   make\n$ sudo cp bioawk /usr/local/sbin  parallel  $ sudo apt install parallel  gplot  $ sudo apt install gnuplot\n$ git clone https://github.com/RhysU/gplot\n$ sudo cp gplot/gplot /usr/local/sbin  FastQC  $ wget http://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip\n$ sudo unzip fastqc_v0.11.5.zip\n$ sudo mv fastqc_v0.11.5 /opt/fastqc   sudo chown -R root:root /opt/fastqc\n$ sudo cp /opt/fastqc/fastqc /usr/local/sbin  Fadapa  $ sudo pip install fadapa  snippy  $ git clone https://github.com/tseemann/snippy\n$ sudo cp snippy/bin/* /usr/local/sbin\n$ sudo cp snippy/binaries/linux/* /usr/local/sbin  RAxML  $ wget https://github.com/stamatak/standard-RAxML/archive/v8.1.17.tar.gz\n$ sudo tar zxf v8.1.17.tar.gz -C /opt/raxml\n$ sudo chown -R root:root /opt/raxml   cd /opt/raxml\n$ sudo make -f Makefile.SSE3.PTHREADS.gcc\n$ sudo ln -s `pwd`/raxmlHPC-PTHREADS-SSE3 /usr/local/raxml", 
            "title": "\u76f8\u5173\u8f6f\u4ef6\u5b89\u88c5"
        }, 
        {
            "location": "/01_anthrax_comparative_analysis/#reference", 
            "text": "edirect help book: http://www.ncbi.nlm.nih.gov/books/NBK179288/  sra-tools wiki: https://github.com/ncbi/sra-tools/wiki  parallel tutorial: https://www.biostars.org/p/63816/  gnuplot tutorial: http://lzz5235.github.io/2016/01/12/gnuplot.html  gplot usage: https://github.com/RhysU/gplot/blob/master/README.md", 
            "title": "Reference"
        }
    ]
}